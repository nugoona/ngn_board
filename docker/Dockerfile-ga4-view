# ✅ Python 3.10 slim 버전 사용
FROM python:3.10-slim

# ✅ 작업 디렉토리 설정
WORKDIR /app

# ✅ 필수 패키지 설치 (GA4 API, BigQuery 연동)
COPY requirements.txt ./
RUN pip install --no-cache-dir -r requirements.txt

# ✅ 프로젝트 관련 파일 복사
COPY ./ngn_wep/GA4_API/ga4_viewitem_today.py /app/ga4_viewitem_today.py
COPY ./config/ngn.env /app/ngn.env
COPY ./config/service-account.json /app/service-account.json

# ✅ 환경변수 설정 (오늘 모드)
ENV GOOGLE_APPLICATION_CREDENTIALS="/app/service-account.json"
ENV RUN_MODE="today"

# ✅ 실행 명령어 설정 (오늘 모드)
#  - "sh -c"를 사용하면 ENTRYPOINT에서 Shell 스크립트처럼 명령문 해석 가능
ENTRYPOINT ["sh", "-c", "python /app/ga4_viewitem_today.py ${RUN_MODE}"]
